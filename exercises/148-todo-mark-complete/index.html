<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exercise 151: Todo Mark Complete - Demo</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>‚úì Todo Mark Complete</h1>
      <p>Master toggling completion status and visual feedback for todos</p>
    </div>

    <div class="main-content">
      <!-- Section 1: Mark Todo Complete -->
      <div class="section">
        <div class="section-title">1. Mark Todo as Complete</div>
        <p>Set a specific todo's completion status to true:</p>
        
        <div class="demo-section">
          <button class="action-button" onclick="demoMarkComplete()">Mark Todo 1 Complete</button>
          <button class="action-button secondary" onclick="demoMarkMultiple()">Mark Multiple</button>
          <div id="markCompleteResult" class="data-display"></div>
        </div>

        <p><strong>Features:</strong></p>
        <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
          <li>Mark specific todo by ID</li>
          <li>Set completed to true</li>
          <li>Preserve all other properties</li>
          <li>Don't mutate original array</li>
        </ul>
      </div>

      <!-- Section 2: Toggle Completion Status -->
      <div class="section">
        <div class="section-title">2. Toggle Completion Status</div>
        <p>Switch completion between true and false:</p>
        
        <div class="demo-section">
          <button class="action-button" onclick="demoToggleStatus()">Toggle Todo 1</button>
          <button class="action-button secondary" onclick="demoToggleMultiple()">Toggle Multiple</button>
          <div id="toggleStatusResult" class="data-display"></div>
        </div>

        <p><strong>Behavior:</strong></p>
        <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
          <li>If completed: false ‚Üí true</li>
          <li>If completed: true ‚Üí false</li>
          <li>Works like checkbox behavior</li>
          <li>Useful for click handlers</li>
        </ul>
      </div>

      <!-- Section 3: Uncomplete Todo -->
      <div class="section">
        <div class="section-title">3. Mark Todo as Pending</div>
        <p>Set a completed todo back to pending (uncomplete):</p>
        
        <div class="demo-section">
          <button class="action-button" onclick="demoUncomplete()">Mark Todo 2 Pending</button>
          <div id="uncompleteResult" class="data-display"></div>
        </div>

        <p><strong>Use Cases:</strong></p>
        <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
          <li>Undo completion action</li>
          <li>Revert completed tasks</li>
          <li>Edit task status back to pending</li>
          <li>Different from toggle (always sets to false)</li>
        </ul>
      </div>

      <!-- Section 4: Get Completed Todos -->
      <div class="section">
        <div class="section-title">4. Get All Completed Todos</div>
        <p>Filter and return only completed todos:</p>
        
        <div class="demo-section">
          <button class="action-button" onclick="demoGetCompleted()">Get Completed</button>
          <ul id="completedList" class="todo-list"></ul>
        </div>

        <p><strong>Features:</strong></p>
        <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
          <li>Filter where completed === true</li>
          <li>Return new filtered array</li>
          <li>Don't modify original</li>
          <li>Ready for display or processing</li>
        </ul>
      </div>

      <!-- Section 5: Get Pending Todos -->
      <div class="section">
        <div class="section-title">5. Get All Pending Todos</div>
        <p>Filter and return only pending todos:</p>
        
        <div class="demo-section">
          <button class="action-button" onclick="demoGetPending()">Get Pending</button>
          <ul id="pendingList" class="todo-list"></ul>
        </div>

        <p><strong>Features:</strong></p>
        <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
          <li>Filter where completed === false</li>
          <li>Show incomplete/active tasks</li>
          <li>Useful for "TODO" views</li>
          <li>Can chain with other operations</li>
        </ul>
      </div>

      <!-- Section 6: Count Statistics -->
      <div class="section">
        <div class="section-title">6. Count Completed & Pending</div>
        <p>Get count of completed, pending, and total todos:</p>
        
        <div class="demo-section">
          <button class="action-button" onclick="demoCountStats()">Calculate Counts</button>
          <div id="countResult" class="data-display"></div>
        </div>

        <p><strong>Returns:</strong></p>
        <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
          <li>completed: Number of completed todos</li>
          <li>pending: Number of pending todos</li>
          <li>total: Total number of todos</li>
        </ul>
      </div>

      <!-- Section 7: Completion Statistics -->
      <div class="section">
        <div class="section-title">7. Get Comprehensive Statistics</div>
        <p>Calculate detailed completion metrics and percentages:</p>
        
        <div class="demo-section">
          <button class="action-button" onclick="demoGetStats()">Calculate Stats</button>
          <div id="statsResult" class="data-display"></div>
        </div>

        <p><strong>Statistics Include:</strong></p>
        <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
          <li>completed: Count of completed</li>
          <li>pending: Count of pending</li>
          <li>total: Total todos</li>
          <li>percentage: Completion % (0-100)</li>
          <li>progress: Visual representation</li>
        </ul>
      </div>

      <!-- Section 8: Render Completion States -->
      <div class="section">
        <div class="section-title">8. Render Todo with Completion State</div>
        <p>Display todos with visual feedback for completion status:</p>
        
        <div class="demo-section">
          <button class="action-button" onclick="demoRenderStates()">Render All States</button>
          <ul id="stateRenderResult" class="todo-list"></ul>
        </div>

        <p><strong>Visual Feedback:</strong></p>
        <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
          <li>Completed: strikethrough text</li>
          <li>Completed: green background</li>
          <li>Pending: normal text</li>
          <li>Status indicator (‚úì or ‚óã)</li>
        </ul>
      </div>

      <!-- Section 9: Progress Bar and Metrics -->
      <div class="section">
        <div class="section-title">9. Interactive Progress & Metrics</div>
        <p>Display interactive progress bar with completion metrics:</p>
        
        <div class="demo-section">
          <button class="action-button" onclick="demoProgressBar()">Show Progress</button>
          <div id="progressResult"></div>
          <div class="action-buttons">
            <button class="action-button secondary" onclick="demoCompleteOne()">Complete One</button>
            <button class="action-button secondary" onclick="demoUncompleteOne()">Uncomplete One</button>
            <button class="action-button secondary" onclick="demoResetProgress()">Reset</button>
          </div>
        </div>

        <p><strong>Interaction Features:</strong></p>
        <ul style="margin: 10px 0 10px 20px; line-height: 1.8;">
          <li>Real-time progress calculation</li>
          <li>Animated progress bar</li>
          <li>Percentage display</li>
          <li>Visual completion indicators</li>
        </ul>
      </div>

      <!-- Stats Dashboard -->
      <div class="section">
        <div class="section-title">üìä Statistics Dashboard</div>
        <div class="stats-grid">
          <div class="stat-card total">
            <div class="stat-label">Total Todos</div>
            <div class="stat-value" id="totalCount">0</div>
          </div>
          <div class="stat-card completed">
            <div class="stat-label">Completed</div>
            <div class="stat-value" id="completedCount">0</div>
          </div>
          <div class="stat-card pending">
            <div class="stat-label">Pending</div>
            <div class="stat-value" id="pendingCount">0</div>
          </div>
          <div class="stat-card total">
            <div class="stat-label">Completion %</div>
            <div class="stat-value" id="percentCount">0%</div>
          </div>
        </div>

        <div class="progress-container" style="margin-top: 20px;">
          <div class="progress-label">
            <span>Overall Progress</span>
            <span id="progressPercent">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressBarFill" style="width: 0%"></div>
          </div>
        </div>

        <div class="action-buttons" style="margin-top: 15px;">
          <button class="action-button secondary" onclick="updateDashboard()">Refresh Stats</button>
          <button class="action-button secondary" onclick="addSampleTodos()">Load Sample</button>
          <button class="action-button secondary" onclick="clearAllTodos()">Clear All</button>
        </div>
      </div>

      <!-- Filter and Display Section -->
      <div class="section">
        <div class="section-title">üîç Filter & Display Todos</div>
        
        <div class="filter-panel">
          <button class="filter-button active" onclick="filterTodos('all')">All Todos</button>
          <button class="filter-button" onclick="filterTodos('completed')">Completed</button>
          <button class="filter-button" onclick="filterTodos('pending')">Pending</button>
        </div>

        <ul id="filteredTodos" class="todo-list"></ul>
      </div>
    </div>
  </div>

  <script>
    // Sample todos for demonstration
    let appTodos = [
      { id: 1, title: 'Learn state management', description: 'Master immutable updates', completed: false },
      { id: 2, title: 'Toggle completion status', description: 'Switch between states', completed: true },
      { id: 3, title: 'Render with feedback', description: 'Visual state indication', completed: false },
      { id: 4, title: 'Track progress', description: 'Calculate completion %', completed: false },
      { id: 5, title: 'Save to storage', description: 'Persist changes', completed: true }
    ];

    let currentFilter = 'all';

    // Helper Functions
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function formatJson(obj) {
      return JSON.stringify(obj, null, 2);
    }

    function displayResult(elementId, title, data, className = '') {
      const element = document.getElementById(elementId);
      const formatted = typeof data === 'string' ? data : formatJson(data);
      element.innerHTML = `
        <strong>${title}:</strong>
        <pre>${escapeHtml(formatted)}</pre>
      `;
      element.className = `data-display ${className}`;
    }

    // Core Logic Functions (to be used with implementations)
    function markTodoComplete(todos, id) {
      return todos.map(todo =>
        todo.id === id ? { ...todo, completed: true } : todo
      );
    }

    function toggleTodoStatus(todos, id) {
      return todos.map(todo =>
        todo.id === id ? { ...todo, completed: !todo.completed } : todo
      );
    }

    function uncompleteTodo(todos, id) {
      return todos.map(todo =>
        todo.id === id ? { ...todo, completed: false } : todo
      );
    }

    function getCompletedTodos(todos) {
      return todos.filter(todo => todo.completed === true);
    }

    function getPendingTodos(todos) {
      return todos.filter(todo => todo.completed === false);
    }

    function countCompleted(todos) {
      const completed = todos.filter(t => t.completed).length;
      return {
        completed,
        pending: todos.length - completed,
        total: todos.length
      };
    }

    function getTodoCompletionStats(todos) {
      const counts = countCompleted(todos);
      const percentage = counts.total === 0 ? 0 : 
        Math.round((counts.completed / counts.total) * 100);
      
      return {
        ...counts,
        percentage
      };
    }

    function renderCompletedState(todo) {
      const status = todo.completed ? 'completed' : 'pending';
      return `
        <li class="todo-item ${status}">
          <div class="todo-content">
            <div class="todo-title">${escapeHtml(todo.title)}</div>
            <div class="todo-description">${escapeHtml(todo.description || '')}</div>
          </div>
          <span class="todo-status ${status}">
            ${todo.completed ? '‚úì Done' : '‚óã Pending'}
          </span>
        </li>
      `;
    }

    // Demo Functions
    function demoMarkComplete() {
      const updated = markTodoComplete(appTodos, 1);
      displayResult('markCompleteResult', 'After Marking Todo 1 Complete', {
        original: appTodos[0],
        updated: updated[0],
        message: 'Note: Original array unchanged'
      });
    }

    function demoMarkMultiple() {
      let updated = appTodos;
      updated = markTodoComplete(updated, 1);
      updated = markTodoComplete(updated, 3);
      
      displayResult('markCompleteResult', 'Multiple Todos Marked', {
        marked: [1, 3],
        todos: updated.map(t => ({ id: t.id, title: t.title, completed: t.completed }))
      });
    }

    function demoToggleStatus() {
      const updated = toggleTodoStatus(appTodos, 1);
      displayResult('toggleStatusResult', 'Toggle Todo 1', {
        before: appTodos[0].completed,
        after: updated[0].completed,
        action: 'Toggled: false ‚Üí true'
      });
    }

    function demoToggleMultiple() {
      let updated = toggleTodoStatus(appTodos, 1);
      updated = toggleTodoStatus(updated, 2);
      updated = toggleTodoStatus(updated, 3);
      
      displayResult('toggleStatusResult', 'Multiple Toggles', {
        todos: updated.map(t => ({ id: t.id, completed: t.completed }))
      });
    }

    function demoUncomplete() {
      const updated = uncompleteTodo(appTodos, 2);
      displayResult('uncompleteResult', 'Uncomplete Todo 2', {
        before: appTodos[2].completed,
        after: updated[2].completed,
        action: 'Changed from true ‚Üí false'
      });
    }

    function demoGetCompleted() {
      const completed = getCompletedTodos(appTodos);
      const list = document.getElementById('completedList');
      list.innerHTML = completed.map(t => renderCompletedState(t)).join('');
      
      displayResult('completedList', '', {
        count: completed.length,
        todos: completed.map(t => t.title)
      });
    }

    function demoGetPending() {
      const pending = getPendingTodos(appTodos);
      const list = document.getElementById('pendingList');
      list.innerHTML = pending.map(t => renderCompletedState(t)).join('');
      
      displayResult('pendingList', '', {
        count: pending.length,
        todos: pending.map(t => t.title)
      });
    }

    function demoCountStats() {
      const stats = countCompleted(appTodos);
      displayResult('countResult', 'Completion Counts', stats);
    }

    function demoGetStats() {
      const stats = getTodoCompletionStats(appTodos);
      displayResult('statsResult', 'Comprehensive Statistics', stats);
    }

    function demoRenderStates() {
      const list = document.getElementById('stateRenderResult');
      list.innerHTML = appTodos.map(t => renderCompletedState(t)).join('');
    }

    function demoProgressBar() {
      const stats = getTodoCompletionStats(appTodos);
      const result = document.getElementById('progressResult');
      
      result.innerHTML = `
        <div class="progress-container">
          <div class="progress-label">
            <span><strong>${stats.completed} of ${stats.total} completed</strong></span>
            <span><strong>${stats.percentage}%</strong></span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill ${stats.percentage === 100 ? 'full' : ''}" 
              style="width: ${stats.percentage}%">
              ${stats.percentage > 10 ? stats.percentage + '%' : ''}
            </div>
          </div>
          <div class="stats-grid" style="margin-top: 15px;">
            <div class="stat-card completed">
              <div class="stat-label">Completed</div>
              <div class="stat-value">${stats.completed}</div>
            </div>
            <div class="stat-card pending">
              <div class="stat-label">Pending</div>
              <div class="stat-value">${stats.pending}</div>
            </div>
            <div class="stat-card total">
              <div class="stat-label">Progress</div>
              <div class="stat-value">${stats.percentage}%</div>
            </div>
          </div>
        </div>
      `;
    }

    function demoCompleteOne() {
      const pending = getPendingTodos(appTodos);
      if (pending.length > 0) {
        appTodos = markTodoComplete(appTodos, pending[0].id);
        demoProgressBar();
        updateDashboard();
        filterTodos(currentFilter);
      }
    }

    function demoUncompleteOne() {
      const completed = getCompletedTodos(appTodos);
      if (completed.length > 0) {
        appTodos = uncompleteTodo(appTodos, completed[0].id);
        demoProgressBar();
        updateDashboard();
        filterTodos(currentFilter);
      }
    }

    function demoResetProgress() {
      appTodos = appTodos.map(t => ({ ...t, completed: false }));
      demoProgressBar();
      updateDashboard();
      filterTodos(currentFilter);
    }

    function updateDashboard() {
      const stats = getTodoCompletionStats(appTodos);
      document.getElementById('totalCount').textContent = stats.total;
      document.getElementById('completedCount').textContent = stats.completed;
      document.getElementById('pendingCount').textContent = stats.pending;
      document.getElementById('percentCount').textContent = stats.percentage + '%';
      document.getElementById('progressPercent').textContent = stats.percentage + '%';
      
      const progressBar = document.getElementById('progressBarFill');
      progressBar.style.width = stats.percentage + '%';
      if (stats.percentage === 100) {
        progressBar.classList.add('full');
      } else {
        progressBar.classList.remove('full');
      }
    }

    function addSampleTodos() {
      appTodos = [
        { id: 1, title: 'Learn state management', description: 'Master immutable updates', completed: false },
        { id: 2, title: 'Toggle completion status', description: 'Switch between states', completed: true },
        { id: 3, title: 'Render with feedback', description: 'Visual state indication', completed: false },
        { id: 4, title: 'Track progress', description: 'Calculate completion %', completed: false },
        { id: 5, title: 'Save to storage', description: 'Persist changes', completed: true }
      ];
      updateDashboard();
      filterTodos(currentFilter);
    }

    function clearAllTodos() {
      appTodos = [];
      updateDashboard();
      filterTodos(currentFilter);
    }

    function filterTodos(filter) {
      currentFilter = filter;
      
      // Update filter buttons
      document.querySelectorAll('.filter-button').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      let toDisplay = appTodos;
      if (filter === 'completed') {
        toDisplay = getCompletedTodos(appTodos);
      } else if (filter === 'pending') {
        toDisplay = getPendingTodos(appTodos);
      }
      
      const list = document.getElementById('filteredTodos');
      if (toDisplay.length === 0) {
        list.innerHTML = `
          <li style="padding: 20px; text-align: center; color: #999;">
            No todos in this category
          </li>
        `;
      } else {
        list.innerHTML = toDisplay.map(t => renderCompletedState(t)).join('');
      }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', () => {
      updateDashboard();
      filterTodos('all');
    });
  </script>
</body>
</html>

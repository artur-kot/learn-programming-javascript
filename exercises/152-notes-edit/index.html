<!DOCTYPE html>
<html data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exercise 155: Notes Edit & Update</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.10.1/dist/full.min.css" rel="stylesheet" />
</head>
<body class="bg-gradient-to-br from-emerald-900 via-teal-900 to-cyan-900 min-h-screen text-white py-8">
  <div class="max-w-6xl mx-auto p-4">
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-5xl font-bold mb-4">Notes Edit & Update</h1>
      <p class="text-xl text-emerald-200">Master immutable updates and state mutations for notes</p>
    </div>

    <!-- Edit Interface -->
    <div class="card bg-base-100 shadow-xl mb-8">
      <div class="card-body">
        <h2 class="card-title mb-6">Interactive Note Editor</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Current Note -->
          <div class="space-y-4">
            <h3 class="font-bold text-lg">Current Note</h3>
            <div class="bg-gray-800 p-4 rounded border border-gray-700 space-y-3">
              <div>
                <label class="label">
                  <span class="label-text">Title</span>
                </label>
                <input type="text" id="noteTitle" placeholder="Note title" class="input input-bordered w-full" />
              </div>
              <div>
                <label class="label">
                  <span class="label-text">Content</span>
                </label>
                <textarea id="noteContent" placeholder="Note content" class="textarea textarea-bordered w-full" rows="4"></textarea>
              </div>
              <div>
                <label class="label">
                  <span class="label-text">Tags</span>
                </label>
                <div id="tagsList" class="flex flex-wrap gap-2 p-2 bg-gray-900 rounded border border-gray-700 min-h-12"></div>
              </div>
              <div class="flex gap-2">
                <input type="text" id="newTag" placeholder="Add tag..." class="input input-bordered flex-1" />
                <button class="btn btn-sm btn-primary" id="addTagBtn">Add</button>
              </div>
            </div>
          </div>

          <!-- Stats & Actions -->
          <div class="space-y-4">
            <h3 class="font-bold text-lg">Note Statistics</h3>
            <div class="bg-gray-800 p-4 rounded border border-gray-700 space-y-3">
              <div class="flex justify-between">
                <span>Characters:</span>
                <span class="font-bold" id="charCount">0</span>
              </div>
              <div class="flex justify-between">
                <span>Words:</span>
                <span class="font-bold" id="wordCount">0</span>
              </div>
              <div class="flex justify-between">
                <span>Tags:</span>
                <span class="font-bold" id="tagCount">0</span>
              </div>
              <div class="flex justify-between">
                <span>Created:</span>
                <span class="font-bold" id="createdDate">—</span>
              </div>
              <div class="flex justify-between">
                <span>Modified:</span>
                <span class="font-bold" id="modifiedDate">—</span>
              </div>
              <div class="divider"></div>
              <button class="btn btn-primary w-full" id="saveBtn">Save Changes</button>
              <button class="btn btn-ghost w-full" id="resetBtn">Reset</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Demo Sections -->
    <div class="space-y-8">
      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">Example 1: Basic Note Update</h2>
          <p class="text-sm text-gray-300 mb-4">Update note properties with immutability</p>
          <div class="bg-gray-900 p-4 rounded font-mono text-sm overflow-x-auto">
            <code class="text-yellow-300">
// Create updated note with new title<br>
const updated = updateNote(note, { title: 'New Title' });<br>
// Original note unchanged<br>
console.log(note.title); // 'Old Title'<br>
console.log(updated.title); // 'New Title'
            </code>
          </div>
        </div>
      </div>

      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">Example 2: Update Note in List</h2>
          <p class="text-sm text-gray-300 mb-4">Update a specific note by ID in an array</p>
          <div class="bg-gray-900 p-4 rounded font-mono text-sm overflow-x-auto">
            <code class="text-yellow-300">
// Update note with id=1 in array<br>
const updated = updateNoteInList(notes, 1, {<br>
&nbsp;&nbsp;title: 'Updated Title',<br>
&nbsp;&nbsp;content: 'Updated content'<br>
});<br>
// Returns new array, original unchanged
            </code>
          </div>
        </div>
      </div>

      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">Example 3: Convenience Functions</h2>
          <p class="text-sm text-gray-300 mb-4">Update specific properties easily</p>
          <div class="bg-gray-900 p-4 rounded font-mono text-sm overflow-x-auto">
            <code class="text-yellow-300">
// Update only title<br>
updateNoteTitle(note, 'New Title');<br>
<br>
// Update only content<br>
updateNoteContent(note, 'New Content');
            </code>
          </div>
        </div>
      </div>

      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">Example 4: Tag Operations</h2>
          <p class="text-sm text-gray-300 mb-4">Add, remove, or replace tags immutably</p>
          <div class="bg-gray-900 p-4 rounded font-mono text-sm overflow-x-auto">
            <code class="text-yellow-300">
// Add tag (prevents duplicates)<br>
const withTag = addTagToNote(note, 'urgent');<br>
<br>
// Remove tag<br>
const withoutTag = removeTagFromNote(note, 'done');<br>
<br>
// Replace tag<br>
const renamed = replaceTagInNote(note, 'todo', 'done');
            </code>
          </div>
        </div>
      </div>

      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">Example 5: Batch Updates</h2>
          <p class="text-sm text-gray-300 mb-4">Update multiple notes matching criteria</p>
          <div class="bg-gray-900 p-4 rounded font-mono text-sm overflow-x-auto">
            <code class="text-yellow-300">
// Archive all work notes<br>
const updated = updateNotesInList(<br>
&nbsp;&nbsp;notes,<br>
&nbsp;&nbsp;n => n.tags.includes('work'),<br>
&nbsp;&nbsp;{ archived: true }<br>
);
            </code>
          </div>
        </div>
      </div>

      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">Example 6: Validation</h2>
          <p class="text-sm text-gray-300 mb-4">Validate updates before applying them</p>
          <div class="bg-gray-900 p-4 rounded font-mono text-sm overflow-x-auto">
            <code class="text-yellow-300">
// Check if updates are valid<br>
const validation = validateNoteUpdate(note, updates);<br>
<br>
if (validation.isValid) {<br>
&nbsp;&nbsp;// Apply updates<br>
} else {<br>
&nbsp;&nbsp;console.error(validation.errors);<br>
}
            </code>
          </div>
        </div>
      </div>

      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">Example 7: Merging Notes</h2>
          <p class="text-sm text-gray-300 mb-4">Combine content from multiple notes</p>
          <div class="bg-gray-900 p-4 rounded font-mono text-sm overflow-x-auto">
            <code class="text-yellow-300">
// Merge note2 and note3 into note1<br>
const merged = mergeNotes([note2, note3], note1);<br>
// merged.content combines all three<br>
// merged.tags merges unique tags
            </code>
          </div>
        </div>
      </div>

      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">Example 8: Immutability Pattern</h2>
          <p class="text-sm text-gray-300 mb-4">Why immutability matters in updates</p>
          <div class="bg-gray-900 p-4 rounded font-mono text-sm overflow-x-auto">
            <code class="text-yellow-300">
// ❌ Mutating (wrong)<br>
note.title = 'New'; // Changes original!<br>
<br>
// ✅ Immutable (correct)<br>
const updated = updateNote(note, { title: 'New' });<br>
// note unchanged, updated is new object
            </code>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Sample note for demo
    let currentNote = {
      id: 1,
      title: 'My First Note',
      content: 'This is the content of my note. I can edit the title, content, and tags.',
      tags: ['important', 'tutorial'],
      createdAt: new Date('2024-01-15'),
      modifiedAt: new Date('2024-01-15')
    };

    const originalNote = JSON.parse(JSON.stringify(currentNote));

    function updateStats() {
      const content = document.getElementById('noteContent').value;
      const chars = content.length;
      const words = content.trim() ? content.trim().split(/\s+/).length : 0;
      
      document.getElementById('charCount').textContent = chars;
      document.getElementById('wordCount').textContent = words;
      document.getElementById('tagCount').textContent = currentNote.tags.length;
      document.getElementById('createdDate').textContent = currentNote.createdAt.toLocaleDateString();
      document.getElementById('modifiedDate').textContent = currentNote.modifiedAt.toLocaleDateString();
    }

    function displayNote() {
      document.getElementById('noteTitle').value = currentNote.title;
      document.getElementById('noteContent').value = currentNote.content;
      renderTags();
      updateStats();
    }

    function renderTags() {
      const tagsList = document.getElementById('tagsList');
      tagsList.innerHTML = currentNote.tags.map(tag => `
        <span class="badge badge-primary badge-lg">
          ${tag}
          <button class="ml-1 cursor-pointer" onclick="removeTag('${tag}')">✕</button>
        </span>
      `).join('');
    }

    function removeTag(tag) {
      currentNote.tags = currentNote.tags.filter(t => t !== tag);
      renderTags();
      updateStats();
    }

    document.getElementById('addTagBtn').addEventListener('click', () => {
      const input = document.getElementById('newTag');
      const tag = input.value.trim().toLowerCase();
      if (tag && !currentNote.tags.includes(tag)) {
        currentNote.tags.push(tag);
        input.value = '';
        renderTags();
        updateStats();
      }
    });

    document.getElementById('saveBtn').addEventListener('click', () => {
      currentNote.title = document.getElementById('noteTitle').value;
      currentNote.content = document.getElementById('noteContent').value;
      currentNote.modifiedAt = new Date();
      updateStats();
      alert('Note saved! (modifiedAt updated)');
    });

    document.getElementById('resetBtn').addEventListener('click', () => {
      currentNote = JSON.parse(JSON.stringify(originalNote));
      displayNote();
    });

    // Initialize
    displayNote();

    // Update stats on input
    document.getElementById('noteContent').addEventListener('input', updateStats);
  </script>
</body>
</html>
